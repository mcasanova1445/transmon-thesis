\chapter{Cálculos de Hamiltonianos}

\section{Hamiltoniano de Jaynes-Cummings}

El Hamiltoniano de Jaynes-Cummings es un Hamiltoniano diagonal que representa un
sistema de dos niveles interactuando con un modo cuantizado de una cavidad óptica.

$$\hat{H}_{JC} = \hat{H}_r + \hat{H}_q + \hat{H}_{qr} = \omega_r a^\dag a - \frac{1}{2} \omega_q \sigma_z + g(a \sigma_+ + a^\dag \sigma_-)$$

\section{Hamiltoniano multiquibit}

El modelo de Jaynes-Cummings para varios qubits sin el término de la energía de la cavidad es el siguiente:

$$\hat{H} = \hat{H}_q + \hat{H}_{qr} = - \frac{1}{2} \sum\limits_i \omega_{qi} \sigma_{zi} + \sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i})$$

\section{Pulsos de microondas}

Para operar sobre los qubits se aplican pulsos de microondas.

$$\hat{H}_d = \sum\limits_k (a+a^\dagger) (\xi_k e^{-i\omega_d^{(k)}t} + \xi_k^*e^{i\omega_d^{(k)}t})$$

RWA: $$\hat{H}_d=\sum\limits_k a\xi_k^*e^{i\omega_d^{(k)}t}+ a^\dagger\xi_ke^{-i\omega_d^{(k)}t}$$

\section{Régimen rotacional del pulso}

Trabajando con un sólo modo a la vez, se aplica la siguiente transformación
$U(t) = exp[\sum\limits_n-i \omega_d^{(n)} t(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})]$ para entrar en el régimen rotacional del pulso de control.

$$\hat{H} = U^\dagger (\hat{H}_{syst} + \hat{H}_d) U - i U^\dagger \dot{U}$$

------------------------------
$e^{-\lambda X} H e^{\lambda X} = H + \lambda [H,X] +
\frac{\lambda^2}{2!}[[H,X],X] + ...$


$$\hat{H} = U^\dagger (\omega_r a^\dag a - \frac{1}{2} \sum\limits_i \omega_{qi}
\sigma_{zi} + \sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i}) +
\sum\limits_k (a\xi_k^*e^{i\sum\limits_k \omega_d^{(k)}t}+
a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t})) U - i U^\dagger \dot{U}$$

$[\omega_r a^\dag a, -i \omega_d t(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})] = 0$

$[- \frac{1}{2} \sum\limits_i \omega_{qi} \sigma_{zi} , -i \omega_d t(a^\dagger
a - \frac{1}{2} \sum\limits_i \sigma_{z i})] = 0$

$[\sigma_+, \sigma_z] = 2 \sigma_+$

$[\sigma_-, \sigma_z] = - 2 \sigma_-$

$[\sigma_-, \sigma_+] = \sigma_z$

$[a, a^\dagger] = 1$

$[a, a^\dagger a] = a a^\dagger a - a^\dagger a a = (a a^\dagger - a^\dagger a) a = [a, a^\dagger] a = a$

$[a^\dagger, a^\dagger a] = a^\dagger a^\dagger a - a^\dagger a a^\dagger = a^\dagger (a^\dagger a - a a^\dagger) = a^\dagger [a^\dagger, a] = -a^\dagger$


$[\sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i}), \sum\limits_n-i \omega_d^{(n)} t(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})] =
\sum\limits_n-i \omega_d^{(n)} t [\sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i}), (a^\dagger a)] 
+ \sum\limits_n-i \omega_d^{(n)} t [\sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i}), (- \frac{1}{2} \sum\limits_i \sigma_{z i})] =
\sum\limits_n-i \omega_d^{(n)} t \sum\limits_i g_i (a \sigma_{+ i} - a^\dagger \sigma_{- i})
- \sum\limits_n-i \omega_d^{(n)} t \sum\limits_i g_i (a \sigma_{+ i} - a^\dagger \sigma_{- i}) = 0 $

$$\hat{H} = U^\dagger (\hat{H}_{syst}) U = \hat{H}_{syst} $$

$[\sum\limits_k (a\xi_k^*e^{i\sum\limits_k \omega_d^{(k)}t}+
a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t}), \sum\limits_n-i \omega_d^{(n)} t(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})] =
(\sum\limits_n-i \omega_d^{(n)} t) \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t} - a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t})
$

$[(\sum\limits_n-i \omega_d^{(n)} t) \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t} - a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t}), \sum\limits_n-i \omega_d^{(n)} t(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})] =
(\sum\limits_n-i \omega_d^{(n)} t)^2 \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t} + a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t}) $
 
$[(\sum\limits_n-i \omega_d^{(n)} t)^2 \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t}+ a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t}), (\sum\limits_n-i \omega_d^{(n)} t)(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})] =
(\sum\limits_n-i \omega_d^{(n)} t)^3 \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t} - a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t})
$

$[(\sum\limits_n-i \omega_d^{(n)} t)^3 \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t} - a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t}), (\sum\limits_n-i \omega_d^{(n)} t)(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})] =
(\sum\limits_n-i \omega_d^{(n)} t)^4 \sum\limits_k (a\xi_k^*e^{i\sum\limits_k
  \omega_d^{(k)}t} + a^\dagger\xi_ke^{-i\sum\limits_k \omega_d^{(k)}t}) $


$e^{-X} H e^{X} = H + [H,X] +
\frac{1}{2!}[[H,X],X] + ...$

% 1 + a + a^2/2! + a^3/3! + a^4/4! + ...
% 1 + (-b) + (-b)^2/2! + (-b)^3/3! + (-b)^4/4! - ...

$$\hat{H} = U^\dagger (\hat{H}_d) U = \sum\limits_k (e^{\sum\limits_n-i \omega_d^{(n)} t}
a\xi_k^*e^{i\sum\limits_k \omega_d^{(k)}t}+ e^{-\sum\limits_n-i \omega_d^{(n)} t}
a^\dagger\xi_ke^{i\sum\limits_k \omega_d^{(k)}t}) = \sum\limits_k (a\xi_k^* + a^\dagger\xi_k)$$

$$- i U^\dagger \dot{U} = - \sum\limits_n \omega_d^{(n)}(a^\dagger a - \frac{1}{2} \sum\limits_i \sigma_{z i})$$

------------------------------

En caso de un sólo drive:

$$ \hat{H} = \Delta_c a^\dagger a - \frac{1}{2} \sum\limits_i \Delta_{qi} \sigma_{zi} + \sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i}) + (a\xi^*+a^\dagger\xi )$$

$\Delta_c = \omega_c - \omega_d \qquad \quad \Delta_{qi} = \omega_{qi} - \omega_d$

\section{Efecto del pulso sobre el qubit}

Luego se aplica el operador de desplazamineto $D(\alpha) = exp[\alpha a^\dagger - \alpha^* a]$ sobre el campo $a$ con $\dot{\alpha} = -i \Delta_c \alpha -i \xi $ para eliminar el efecto directo del pulso sobre la cavidad.

$$\hat{H} = D^\dagger (\alpha) \hat{H}_{old} D(\alpha) -i D^\dagger(\alpha) \dot{D}(\alpha)$$

------------------------------
$$ \hat{H} = \Delta_c a^\dagger a - \frac{1}{2} \sum\limits_i \Delta_{qi} \sigma_{zi} + \sum\limits_i g_i (a \sigma_{+ i} + a^\dagger \sigma_{- i}) + (a\xi^*+a^\dagger\xi )$$

\begin{align*}
  \hat{H} = \Delta_c (a^\dagger + \alpha^*) (a + \alpha) - \frac{1}{2} \sum\limits_i \Delta_{qi} \sigma_{zi} + \sum\limits_i g_i ((a+\alpha) \sigma_{+ i} + (a^\dagger+\alpha^*) \sigma_{- i}) \\
  + ((a+\alpha)\xi^*+(a^\dagger+\alpha^*)\xi ) -i(\dot{\alpha} (a^\dagger + \alpha^*) - \dot{\alpha}^* (a + \alpha))
\end{align*}


------------------------------

$$\hat{H} = \Delta_c a^\dagger a - \frac{1}{2} \sum\limits_i \Delta_{qi} \sigma_{zi} + \sum\limits_i g_i (a \sigma_{+i} + a^\dagger \sigma_{-i})$$
$$ + \sum\limits_i g_i (\alpha \sigma_{+i} + \alpha^* \sigma_{-i}) - \Delta_c \alpha \alpha^* $$

El término $-\Delta_c \alpha \alpha^*$ se desprecia, ya que sólo representa una fase global en la evolución del sistema.

\section{Régimen dispersivo}

Finalmente, aplicamos la transformación $U = exp[\sum\limits_i \frac{g_i}
{\Delta_i} (a^\dagger \sigma_{-i} - a \sigma_{+i})]$, donde $\Delta_i =
\omega_{qi} - \omega_c$ y realizamos la expansión de Baker-Campbell-Hausdorff de segundo grado sobre los términos $\frac{g_i}{\Delta_i} \ll 1$.

$$\hat{H} = U^\dagger \hat{H}_{old} U$$

------------------------------

$[\sigma_+, \sigma_z] = 2 \sigma_+$

$[\sigma_-, \sigma_z] = - 2 \sigma_-$

$[\sigma_-, \sigma_+] = \sigma_z$

$[a, a^\dagger] = 1$

$[a, a^\dagger a] = a$

$[a^\dagger, a^\dagger a] = -a^\dagger$

$$\hat{H} = \Delta_r a^\dagger a - \frac{1}{2} \sum\limits_i \Delta_{qi} \sigma_{zi} + \sum\limits_i g_i (a \sigma_{+i} + a^\dagger \sigma_{-i})$$
$$ + \sum\limits_i g_i (\alpha \sigma_{+i} + \alpha^* \sigma_{-i})$$

$[\Delta_r a^\dagger a, \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger
\sigma_{-i} - a \sigma_{+i})] = \Delta_r \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger \sigma_{-i} + a \sigma_{+i})$

$[- \frac{1}{2} \sum\limits_i \Delta_{qi} \sigma_{zi}, \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger \sigma_{-i} - a \sigma_{+i})] = 
- \sum\limits_i \frac{g_i} {\Delta_i} \Delta_{qi} (a^\dagger \sigma_{-i} + a \sigma_{+i}) $

$[\sum\limits_i g_i (a \sigma_{+i} + a^\dagger \sigma_{-i}), \sum\limits_j \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j} - a \sigma_{+j})] = 
[\sum\limits_i g_i (a \sigma_{+i}), \sum\limits_j \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j})] +
[\sum\limits_i g_i (a \sigma_{+i}), \sum\limits_j \frac{g_j} {\Delta_j} (- a \sigma_{+j})] +
[\sum\limits_i g_i (a^\dagger \sigma_{-i}), \sum\limits_j \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j})] +
[\sum\limits_i g_i (a^\dagger \sigma_{-i}), \sum\limits_j \frac{g_j} {\Delta_j} (- a \sigma_{+j})] =
\sum\limits_{ij} g_i (a \sigma_{+i}) \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j}) -
\sum\limits_{ij} \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j}) g_i (a \sigma_{+i}) +
\sum\limits_{ij} g_i (a^\dagger \sigma_{-i}) \frac{g_j} {\Delta_j} (- a \sigma_{+j}) -
\sum\limits_{ij} \frac{g_j} {\Delta_j} (- a \sigma_{+j}) g_i (a^\dagger \sigma_{-i}) = 
\sum\limits_{ij} g_i \frac{g_j} {\Delta_j} a a^\dagger \sigma_{+i} \sigma_{-j} -
\sum\limits_{ij} g_i \frac{g_j} {\Delta_j} a^\dagger a \sigma_{-j} \sigma_{+i} -
\sum\limits_{ij} g_i \frac{g_j} {\Delta_j} a^\dagger a \sigma_{-i} \sigma_{+j} +
\sum\limits_{ij} g_i \frac{g_j} {\Delta_j} a a^\dagger \sigma_{+j} \sigma_{-i} = 
2 \sum\limits_{i \neq j} g_i \frac{g_j} {\Delta_j} \sigma_{+i} \sigma_{-j} +
\sum\limits_{i} g_i \frac{g_i} {\Delta_i} \sigma_{+i} \sigma_{-i} +
\sum\limits_{i} g_i \frac{g_i} {\Delta_i} \sigma_{+i} \sigma_{-i} -
2 \sum\limits_{i} g_i \frac{g_i} {\Delta_i} a^\dagger a \sigma_{zi} = $

---
$[\sum\limits_i g_i (a \sigma_{+i} + a^\dagger \sigma_{-i}), \sum\limits_j \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j} - a \sigma_{+j})] = 
[\sum\limits_i g_i (a \sigma_{+i}), \sum\limits_j \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j})] +
[\sum\limits_i g_i (a \sigma_{+i}), \sum\limits_j \frac{g_j} {\Delta_j} (- a \sigma_{+j})] +
[\sum\limits_i g_i (a^\dagger \sigma_{-i}), \sum\limits_j \frac{g_j} {\Delta_j} (a^\dagger \sigma_{-j})] +
[\sum\limits_i g_i (a^\dagger \sigma_{-i}), \sum\limits_j \frac{g_j} {\Delta_j} (- a \sigma_{+j})] $

$i \neq j$

$ \sum\limits_{i \neq j} g_i \frac{g_j} {\Delta_j} \sigma_{+i} \sigma_{-j} + \sigma_{-i} \sigma_{+j} $

$i = j$

$ 
2 \sum\limits_i g_i \frac{g_i} {\Delta_i} (a a^\dagger \sigma_{+i} \sigma_{-i} - a^\dagger a \sigma_{-i} \sigma_{+i}) =
2 \sum\limits_i g_i \frac{g_i} {\Delta_i} (a a^\dagger \sigma_{+i} \sigma_{-i} - a^\dagger a (\sigma_{zi} + \sigma_{+i} \sigma_{-i})) =
2 \sum\limits_i g_i \frac{g_i} {\Delta_i} (\sigma_{+i} \sigma_{-i} - a^\dagger a \sigma_{zi}) =
$

$ 2 \sum\limits_i g_i \frac{g_i} {\Delta_i} (a a^\dagger \sigma_{+i} \sigma_{-i} - a^\dagger a \sigma_{-i} \sigma_{+i}) =
2 \sum\limits_i g_i \frac{g_i} {\Delta_i} ((a a^\dagger + 1/2 - 1/2) \sigma_{+i} \sigma_{-i} - (a^\dagger a + 1/2 - 1/2) \sigma_{-i} \sigma_{+i}) =
\sum\limits_i g_i \frac{g_i} {\Delta_i} (\sigma_{+i} \sigma_{-i} + \sigma_{-i} \sigma_{+i}) -
2 \sum\limits_i g_i \frac{g_i} {\Delta_i} (a^\dagger a + 1/2) \sigma_{zi} =
\sum\limits_i (g_i \frac{g_i} {\Delta_i} - 2 g_i \frac{g_i} {\Delta_i} (a^\dagger a + 1/2) \sigma_{zi}) $
---


$ [\sum\limits_i g_i (\alpha \sigma_{+i} + \alpha^* \sigma_{-i}), \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger \sigma_{-i} - a \sigma_{+i})] =
[\sum\limits_i g_i (\alpha \sigma_{+i}), \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger \sigma_{-i})] +
[\sum\limits_i g_i (\alpha^* \sigma_{-i}), \sum\limits_i \frac{g_i} {\Delta_i} (- a \sigma_{+i})] =
- \sum\limits_i g_i \frac{g_i} {\Delta_i} (\alpha a^\dagger + \alpha^* a) \sigma_{zi} $


$\hat{H} = \Delta_r a^\dagger a - \frac{1}{2} \sum\limits_i \Delta_{qi}
\sigma_{zi} + \sum\limits_i g_i (a \sigma_{+i} + a^\dagger \sigma_{-i}) +
\sum\limits_i g_i (\alpha \sigma_{+i} + \alpha^* \sigma_{-i}) +
\Delta_r \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger \sigma_{-i} + a \sigma_{+i}) -
\sum\limits_i \frac{g_i} {\Delta_i} \Delta_{qi} (a^\dagger \sigma_{-i} + a \sigma_{+i}) +
\sum\limits_{i \neq j} g_i \frac{g_j} {\Delta_j} \sigma_{+i} \sigma_{-j} + \sigma_{-i} \sigma_{+j} +
\sum\limits_i (g_i \frac{g_i} {\Delta_i} - 2 g_i \frac{g_i} {\Delta_i} (a^\dagger a + 1/2) \sigma_{zi}) -
\sum\limits_i g_i \frac{g_i} {\Delta_i} (\alpha a^\dagger + \alpha^* a) \sigma_{zi} 
$

$\hat{H} = \Delta_r a^\dagger a - \sum\limits_i \Delta_{qi} (1/2 + 2 g_i \frac{g_i} {\Delta_i} (a^\dagger a + 1/2))
\sigma_{zi} + \sum\limits_i g_i (a \sigma_{+i} + a^\dagger \sigma_{-i}) +
\Delta_r \sum\limits_i \frac{g_i} {\Delta_i} (a^\dagger \sigma_{-i} + a \sigma_{+i}) -
\sum\limits_i \frac{g_i} {\Delta_i} \Delta_{qi} (a^\dagger \sigma_{-i} + a \sigma_{+i}) +
\sum\limits_{i \neq j} g_i \frac{g_j} {\Delta_j} \sigma_{+i} \sigma_{-j} + \sigma_{-i} \sigma_{+j} +
\sum\limits_i g_i (\alpha \sigma_{+i} + \alpha^* \sigma_{-i}) -
\sum\limits_i g_i \frac{g_i} {\Delta_i} (\alpha a^\dagger + \alpha^* a) \sigma_{zi} 
$


$\hat{H} = \Delta_r a^\dagger a - \sum\limits_i \Delta_{qi} (\frac{1}{2} + 2 \frac{g_i^2} {\Delta_i} (a^\dagger a + \frac{1}{2})) \sigma_{zi} +
\sum\limits_{i \neq j} \frac{g_i g_j} {\Delta_j} (\sigma_{+i} \sigma_{-j} +
\sigma_{-i} \sigma_{+j}) +
\sum\limits_i g_i (\alpha \sigma_{+i} + \alpha^* \sigma_{-i}) -
\sum\limits_i \frac{g_i^2} {\Delta_i} (\alpha a^\dagger + \alpha^* a) \sigma_{zi} $ 
------------------------------

$$\hat{H} \approx \tilde{\Delta}_c a^\dagger a - \frac{1}{2} \sum\limits_i \tilde{\Delta}_{qi} \sigma_{zi} + \sum\limits_i (\Omega_i \sigma_{+i} + \Omega_i^* \sigma_{-i})$$
$$+ \sum\limits_{i \neq j} \frac{g_i g_j}{2 \Delta_i} (\sigma_{-i} \sigma_{+j}+\sigma_{+i} \sigma_{-j})$$

$\tilde{\Delta}_c = (\omega_c + \sum\limits_i \chi_i \sigma_{zi}) - \omega_d \qquad \tilde{\Delta}_{qi} = (\omega_{qi} + \chi_i) - \omega_d \qquad \chi_i = \frac{g_i^2}{\Delta_i}$

\section{Rotaciones X-Y}

Tomando $\Omega(t) = \Omega^x(t) \cos(\omega_d t) + \Omega^y \sin(\omega_d t)$, donde $\omega_d$ es igual a la frecuencia de resonancia de uno de los qubits logramos rotaciones sobre los ejes X e Y. Las amplitudes de estas rotaciones vienen dadas por $\int_0^{t_0} \Omega^x(t) dt$ y $\int_0^{t_0} \Omega^y(t) dt$, respectivamente, donde $t_0$ es la duración del pulso.

------------------------
$$ \Omega \sigma_+ + \Omega^* \sigma_- $$

$$ e^{i(x+\pi/2)}-e^{-i(x+\pi/2)} = e^{i\pi/2}e^{ix}-e^{-i\pi/2}e^{-ix} =
e^{i\pi/2}e^{ix}+e^{i\pi}e^{-i\pi/2}e^{-ix} = e^{i\pi/2}e^{ix}+e^{i\pi/2}e^{-ix} = e^{i\pi/2}(e^{ix}+e^{-ix})$$
------------------------

$$\hat{H} \approx \tilde{\Delta}_c a^\dagger a + \frac{1}{2} \tilde{\Delta}_q \sigma_z + \frac{1}{2} (\Omega^x(t) \sigma_x + \Omega^y(t) \sigma_y)$$

\section{Compuerta de entrelazamiento}

Ejemplo con sólo dos qubits

$$\hat{H} \approx \frac{1}{2} \tilde{\Delta}_{q_1} \sigma_{z_1} + \frac{1}{2} \tilde{\Delta}_{q_2} \sigma_{z_2} + \frac{g_1 g_2 (\Delta_1 + \Delta_2)}{2 \Delta_1 \Delta_2} (\sigma_{-_1} \sigma_{+_2} + \sigma_{+_1} \sigma_{-_2})$$

Variando la frecuencia de resonacia de los qubit, se puede variar el acoplamiento entre estos. 


